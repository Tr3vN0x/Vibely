<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Vibely – Full Social App</title>

<!-- Firebase SDKs -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-storage-compat.js"></script>

<style>
:root{--blue:#1877f2}
*{box-sizing:border-box}
body{margin:0;font-family:system-ui;background:#f0f2f5}
header{background:var(--blue);color:#fff;padding:12px 16px;display:flex;justify-content:space-between;align-items:center}
nav{display:flex;gap:8px;flex-wrap:wrap}
nav button{background:rgba(255,255,255,.15);color:#fff}
button{cursor:pointer;border:none;border-radius:8px;padding:8px 12px}
.primary{background:var(--blue);color:white}
.container{display:grid;grid-template-columns:260px 1fr 320px;gap:14px;padding:14px}
.card{background:#fff;border-radius:14px;padding:14px;margin-bottom:12px;box-shadow:0 2px 4px rgba(0,0,0,.05)}
input,textarea{width:100%;padding:10px;border-radius:8px;border:1px solid #ccc}
.hidden{display:none}
.avatar{width:40px;height:40px;border-radius:50%;background:#888;display:flex;align-items:center;justify-content:center;color:#fff;font-weight:bold}
.preview{display:flex;gap:10px;align-items:center}
.badge{color:#1da1f2;font-weight:bold;margin-left:4px}
.post img,.post video{max-width:100%;border-radius:10px;margin-top:8px}
@media(max-width:900px){.container{grid-template-columns:1fr}}
</style>
</head>
<body>

<header>
<b>Vibely</b>
<nav>
<button onclick="showTab('feed')">Feed</button>
<button onclick="showTab('friends')">Friends</button>
<button onclick="showTab('reels')">Reels</button>
<button onclick="showTab('notifications')">Notifications</button>
<button onclick="logout()">Logout</button>
</nav>
</header>

<!-- AUTH -->
<div id="auth" class="card" style="max-width:420px;margin:80px auto">
<h3>Login / Register</h3>
<input id="email" placeholder="Email" />
<input id="password" type="password" placeholder="Password" />
<button class="primary" onclick="login()">Login</button>
<button class="primary" onclick="register()">Register</button>
<p id="authError" style="color:red"></p>
</div>

<!-- APP -->
<div id="app" class="hidden">
<div class="container">

<!-- LEFT -->
<div>
<div class="card">
<h4>Profile</h4>
<input id="username" placeholder="Username" />
<label><input type="checkbox" id="verified" /> Premium Verified</label>
<button onclick="saveProfile()">Save</button>
</div>
</div>

<!-- CENTER -->
<div>

<div id="feed" class="tab">
<div class="card">
<textarea id="postText" placeholder="What's on your mind?"></textarea>
<input type="file" id="imageUpload" />
<button class="primary" onclick="createPost()">Post</button>
</div>
<div id="posts"></div>
</div>

<div id="friends" class="tab hidden">
<div class="card"><h4>Friend Requests</h4><div id="requests"></div></div>
<div class="card"><h4>Followers</h4><div id="followers"></div></div>
</div>

<div id="reels" class="tab hidden">
<div class="card">
<input type="file" id="videoUpload" />
<button onclick="uploadReel()">Upload Reel</button>
</div>
<div id="reelFeed"></div>
</div>

<div id="notifications" class="tab hidden">
<div class="card" id="notify"></div>
</div>

</div>

<!-- RIGHT -->
<div>
<div class="card">
<h4>Chat</h4>
<div id="chat" style="height:260px;overflow:auto"></div>
<input id="chatText" placeholder="Message" />
<button onclick="sendMessage()">Send</button>
</div>
</div>

</div>
</div>

<script>
// Firebase Config
const firebaseConfig={
apiKey:"AIzaSyCDll8RH1kzGOf-ixJmSlHXGssOHSMlO3s",
authDomain:"vibely-5128e.firebaseapp.com",
projectId:"vibely-5128e",
storageBucket:"vibely-5128e.firebasestorage.app",
messagingSenderId:"1048550825812",
appId:"1:1048550825812:web:fc5bbba51e065807ffb2c1"
};

firebase.initializeApp(firebaseConfig);
const auth=firebase.auth();
const db=firebase.firestore();
const storage=firebase.storage();

const authDiv=document.getElementById('auth');
const appDiv=document.getElementById('app');
const authError=document.getElementById('authError');

auth.onAuthStateChanged(user=>{
if(user){authDiv.style.display='none';appDiv.classList.remove('hidden');loadFeed();loadChat();loadNotifications();}
else{authDiv.style.display='block';appDiv.classList.add('hidden');}
});

function showTab(tab){document.querySelectorAll('.tab').forEach(t=>t.classList.add('hidden'));document.getElementById(tab).classList.remove('hidden')}

function register(){auth.createUserWithEmailAndPassword(email.value,password.value).catch(e=>authError.innerText=e.message)}
function login(){auth.signInWithEmailAndPassword(email.value,password.value).catch(e=>authError.innerText=e.message)}
function logout(){auth.signOut()}

function saveProfile(){db.collection('users').doc(auth.currentUser.uid).set({username:username.value,verified:verified.checked},{merge:true})}

function createPost(){
const text=postText.value;const file=imageUpload.files[0];
if(file){const ref=storage.ref('images/'+Date.now()+file.name);ref.put(file).then(r=>r.ref.getDownloadURL().then(url=>savePost(text,url)))}
else savePost(text,null);
postText.value='';imageUpload.value='';}

function savePost(text,image){db.collection('posts').add({text,image,uid:auth.currentUser.uid,likes:0,created:firebase.firestore.FieldValue.serverTimestamp()})}

function loadFeed(){db.collection('posts').orderBy('created','desc').onSnapshot(s=>{posts.innerHTML='';s.forEach(d=>{const p=d.data();posts.innerHTML+=`<div class='card post'><p>${p.text||''}</p>${p.image?`<img src='${p.image}'>`:''}<button onclick="likePost('${d.id}')">❤️ ${p.likes||0}</button></div>`})})}
function likePost(id){db.collection('posts').doc(id).update({likes:firebase.firestore.FieldValue.increment(1)})}

function sendMessage(){if(!chatText.value)return;db.collection('chat').add({text:chatText.value,created:firebase.firestore.FieldValue.serverTimestamp()});chatText.value=''}
function loadChat(){db.collection('chat').orderBy('created').onSnapshot(s=>{chat.innerHTML='';s.forEach(d=>chat.innerHTML+=`<div>${d.data().text}</div>`)});}

function loadNotifications(){db.collection('notifications').onSnapshot(s=>{notify.innerHTML='';s.forEach(d=>notify.innerHTML+=`<div>${d.data().text}</div>`)});}

function uploadReel(){const f=videoUpload.files[0];if(!f)return;const ref=storage.ref('reels/'+Date.now()+f.name);ref.put(f).then(r=>r.ref.getDownloadURL().then(url=>db.collection('reels').add({url,created:firebase.firestore.FieldValue.serverTimestamp()})))}
</script>
</body>
</html>
