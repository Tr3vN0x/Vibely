<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Vibely | Premium Lounge</title>

  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

  <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@700;900&family=Plus+Jakarta+Sans:wght@300;400;600;800&display=swap" rel="stylesheet" />

  <style>
    :root {
      --gold: #d4af37;
      --gold-bright: #facc15;
      --dark-bg: #0a0a0a;
      --card-bg: #161616;
      --border: rgba(212, 175, 55, 0.3);
      --glass: rgba(255, 255, 255, 0.03);
    }

    * { box-sizing: border-box; transition: all 0.3s ease; }
    
    body {
      margin: 0;
      font-family: 'Plus Jakarta Sans', sans-serif;
      background: var(--dark-bg);
      background-image: radial-gradient(circle at center, #1a1a1a 0%, #0a0a0a 100%);
      color: #e5e5e5;
      height: 100vh;
      display: flex;
      flex-direction: column;
      overflow: hidden;
    }

    /* Header & Stats */
    header {
      padding: 1rem 3rem;
      background: rgba(0,0,0,0.9);
      display: flex;
      justify-content: space-between;
      align-items: center;
      border-bottom: 2px solid var(--gold);
      box-shadow: 0 4px 20px rgba(0,0,0,0.5);
      z-index: 100;
    }

    .logo {
      font-family: 'Cinzel', serif;
      color: var(--gold);
      font-size: 1.8rem;
      letter-spacing: 4px;
      text-shadow: 0 0 10px rgba(212, 175, 55, 0.5);
    }

    .stats-bar {
      display: flex;
      gap: 20px;
      font-weight: 800;
      background: var(--glass);
      padding: 8px 20px;
      border-radius: 50px;
      border: 1px solid var(--border);
    }

    .diamond-count { color: var(--gold-bright); }

    /* Layout */
    .layout {
      display: grid;
      grid-template-columns: 260px 1fr 340px;
      flex: 1;
      overflow: hidden;
    }

    /* Sidebar Navigation */
    nav {
      padding: 2rem 1rem;
      background: rgba(0,0,0,0.4);
      border-right: 1px solid var(--border);
      display: flex;
      flex-direction: column;
      gap: 10px;
    }

    .nav-link {
      padding: 15px 20px;
      border-radius: 12px;
      font-size: 0.8rem;
      font-weight: 700;
      text-transform: uppercase;
      letter-spacing: 1px;
      color: #888;
      cursor: pointer;
      border-left: 3px solid transparent;
    }

    .nav-link:hover, .nav-link.active {
      background: var(--glass);
      color: var(--gold);
      border-left: 3px solid var(--gold);
    }

    /* Main Content */
    main { padding: 2rem; overflow-y: auto; background: transparent; }
    
    .view { display: none; animation: slideUp 0.5s ease; }
    @keyframes slideUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }

    /* Cards & Grids */
    .grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(220px, 1fr)); gap: 20px; }

    .player-card {
      background: var(--card-bg);
      border: 1px solid var(--border);
      border-radius: 15px;
      padding: 1.5rem;
      text-align: center;
      position: relative;
      overflow: hidden;
    }

    .player-card::before {
      content: '';
      position: absolute;
      top: 0; left: 0; width: 100%; height: 4px;
      background: linear-gradient(90deg, transparent, var(--gold), transparent);
    }

    .avatar-frame {
      width: 100px; height: 100px;
      margin: 0 auto 15px;
      border-radius: 50%;
      padding: 4px;
      background: linear-gradient(45deg, var(--gold), #554400);
    }

    .avatar-frame img {
      width: 100%; height: 100%;
      border-radius: 50%;
      object-fit: cover;
      background: #000;
    }

    /* Interactive Elements */
    .btn {
      background: linear-gradient(135deg, #d4af37 0%, #8a6d3b 100%);
      color: #000;
      border: none;
      padding: 12px 24px;
      border-radius: 8px;
      font-weight: 900;
      text-transform: uppercase;
      cursor: pointer;
      width: 100%;
      margin-top: 10px;
    }

    .btn:hover { transform: scale(1.03); box-shadow: 0 0 15px rgba(212, 175, 55, 0.4); }
    .btn:disabled { filter: grayscale(1); cursor: not-allowed; }

    /* Chat Area */
    aside {
      background: rgba(0,0,0,0.5);
      border-left: 1px solid var(--border);
      display: flex;
      flex-direction: column;
      padding: 1.5rem;
    }

    .chat-box { flex: 1; overflow-y: auto; display: flex; flex-direction: column; gap: 10px; padding-bottom: 1rem; }
    .chat-msg {
      background: var(--glass);
      padding: 12px;
      border-radius: 10px;
      border: 1px solid rgba(255,255,255,0.05);
      font-size: 0.85rem;
    }

    .chat-msg b { color: var(--gold); display: block; margin-bottom: 4px; font-size: 0.7rem; text-transform: uppercase; }

    input, textarea {
      background: #000;
      border: 1px solid var(--border);
      color: #fff;
      padding: 12px;
      border-radius: 8px;
      width: 100%;
      outline: none;
    }

    /* Wheel Style */
    .wheel-container { position: relative; width: 320px; margin: 2rem auto; }
    .wheel {
      width: 320px; height: 320px;
      border-radius: 50%;
      border: 8px solid var(--gold);
      background: conic-gradient(
        #111 0deg 45deg, #222 45deg 90deg,
        #111 90deg 135deg, #222 135deg 180deg,
        #111 180deg 225deg, #222 225deg 270deg,
        #111 270deg 315deg, var(--gold) 315deg 360deg
      );
      box-shadow: 0 0 50px rgba(212, 175, 55, 0.2);
    }
    .needle {
      position: absolute; top: -15px; left: 50%; transform: translateX(-50%);
      width: 0; height: 0;
      border-left: 15px solid transparent; border-right: 15px solid transparent;
      border-top: 30px solid var(--gold-bright); z-index: 10;
    }

  </style>
</head>
<body>

<header>
  <div class="logo">VIBELY</div>
  <div class="stats-bar">
    <span>LVL <span id="lvl">1</span></span>
    <span class="diamond-count">‚ô¶ <span id="diamonds">0</span></span>
  </div>
</header>

<div class="layout">
  <nav>
    <div class="nav-link active" onclick="show('lounge', this)">Lounge</div>
    <div class="nav-link" onclick="show('wheel', this)">Rewards</div>
    <div class="nav-link" onclick="show('shop', this)">Elite Shop</div>
    <div class="nav-link" onclick="show('profile', this)">My Card</div>
  </nav>

  <main>
    <section id="v-lounge" class="view" style="display:block;">
      <h2 style="font-family:Cinzel;">Member Lounge</h2>
      <div id="player-list" class="grid"></div>
    </section>

    <section id="v-wheel" class="view">
      <h2 style="font-family:Cinzel; text-align: center;">Daily Spin</h2>
      <div class="wheel-container">
        <div class="needle"></div>
        <div id="main-wheel" class="wheel"></div>
      </div>
      <button id="spin-btn" class="btn" onclick="handleSpin()">Spin for Diamonds</button>
      <p id="spin-status" style="text-align:center; color: var(--gold); font-weight: bold; margin-top: 15px;"></p>
    </section>

    <section id="v-shop" class="view">
      <h2 style="font-family:Cinzel;">Elite Shop</h2>
      <div class="grid">
        <div class="player-card">
          <div style="font-size: 2rem;">üèÜ</div>
          <h3>Gold Badge</h3>
          <p>Status symbol for winners.</p>
          <button class="btn" onclick="buy(500)">Buy (‚ô¶ 500)</button>
        </div>
        <div class="player-card">
          <div style="font-size: 2rem;">‚ö°</div>
          <h3>XP Booster</h3>
          <p>Level up twice as fast.</p>
          <button class="btn" onclick="buy(250)">Buy (‚ô¶ 250)</button>
        </div>
      </div>
    </section>

    <section id="v-profile" class="view">
      <h2 style="font-family:Cinzel;">Profile Management</h2>
      <div class="player-card" style="max-width: 450px; margin: 0 auto;">
        <div class="avatar-frame"><img id="prof-img" src=""></div>
        <input id="upd-img" placeholder="New Avatar URL" style="margin-bottom: 10px;">
        <textarea id="upd-bio" placeholder="Update your status..."></textarea>
        <button class="btn" onclick="updateProfile()">Save Identity</button>
      </div>
    </section>
  </main>

  <aside>
    <div id="chat-stream" class="chat-box"></div>
    <div style="margin-top: 10px;">
      <input id="chat-input" placeholder="Say something..." onkeypress="if(event.key==='Enter') postMsg()">
    </div>
  </aside>
</div>

<script>
// --- PASTE YOUR FIREBASE CONFIG HERE ---
const firebaseConfig = { /* PASTE CONFIG DATA HERE */ };

firebase.initializeApp(firebaseConfig);
const db = firebase.firestore();
const auth = firebase.auth();

let user = null;
let rotation = 0;

auth.signInAnonymously();

auth.onAuthStateChanged(async u => {
  if (!u) return;
  const ref = db.collection('users').doc(u.uid);
  const doc = await ref.get();
  
  if (!doc.exists) {
    await ref.set({
      name: 'User_' + u.uid.substring(0,5),
      avatar: 'https://api.dicebear.com/7.x/avataaars/svg?seed=' + u.uid,
      bio: 'New Member',
      diamonds: 200,
      xp: 0
    });
  }
  ref.onSnapshot(s => { user = s.data(); refreshUI(); });
});

function refreshUI() {
  if(!user) return;
  document.getElementById('diamonds').innerText = user.diamonds;
  document.getElementById('lvl').innerText = Math.floor(user.xp / 100) + 1;
  document.getElementById('prof-img').src = user.avatar;
}

function show(id, el) {
  document.querySelectorAll('.view').forEach(v => v.style.display = 'none');
  document.querySelectorAll('.nav-link').forEach(n => n.classList.remove('active'));
  document.getElementById('v-' + id).style.display = 'block';
  el.classList.add('active');
}

function handleSpin() {
  const btn = document.getElementById('spin-btn');
  const wheel = document.getElementById('main-wheel');
  const status = document.getElementById('spin-status');
  
  btn.disabled = true;
  status.innerText = "The wheel is spinning...";
  
  const addRot = 1800 + Math.floor(Math.random() * 360);
  rotation += addRot;
  wheel.style.transform = `rotate(${rotation}deg)`;
  wheel.style.transition = "transform 4s cubic-bezier(0.15, 0, 0.15, 1)";

  setTimeout(() => {
    const wins = [50, 100, 20, 10, 200, 50, 10, 500];
    const prize = wins[Math.floor(Math.random() * wins.length)];
    
    db.collection('users').doc(auth.currentUser.uid).update({
      diamonds: firebase.firestore.FieldValue.increment(prize),
      xp: firebase.firestore.FieldValue.increment(15)
    });
    
    status.innerText = `Congratulations! You won ‚ô¶ ${prize}`;
    btn.disabled = false;
  }, 4000);
}

function buy(cost) {
  if (user.diamonds < cost) return alert("Not enough diamonds!");
  db.collection('users').doc(auth.currentUser.uid).update({
    diamonds: firebase.firestore.FieldValue.increment(-cost)
  });
  alert("Item purchased!");
}

function updateProfile() {
  const img = document.getElementById('upd-img').value;
  const bio = document.getElementById('upd-bio').value;
  db.collection('users').doc(auth.currentUser.uid).update({
    avatar: img || user.avatar,
    bio: bio || user.bio
  });
}

function postMsg() {
  const input = document.getElementById('chat-input');
  if(!input.value.trim()) return;
  
  db.collection('chat').add({
    user: user.name,
    text: input.value,
    ts: Date.now()
  });
  input.value = '';
}

// Listeners
db.collection('chat').orderBy('ts', 'desc').limit(20).onSnapshot(s => {
  const stream = document.getElementById('chat-stream');
  stream.innerHTML = '';
  s.docs.reverse().forEach(d => {
    const m = d.data();
    stream.innerHTML += `<div class="chat-msg"><b>${m.user}</b>${m.text}</div>`;
  });
  stream.scrollTop = stream.scrollHeight;
});

db.collection('users').onSnapshot(s => {
  const list = document.getElementById('player-list');
  list.innerHTML = '';
  s.forEach(d => {
    const p = d.data();
    list.innerHTML += `
      <div class="player-card">
        <div class="avatar-frame"><img src="${p.avatar}"></div>
        <div style="font-weight:bold; color:var(--gold);">${p.name}</div>
        <div style="font-size:0.7rem; margin-top:5px; color:#888;">${p.bio}</div>
      </div>`;
  });
});
</script>
</body>
</html>
