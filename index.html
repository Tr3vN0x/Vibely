<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vibely | The Diamond Lounge</title>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
    
    <style>
        :root {
            --diamond: #e0f7fa;
            --gold: #d4af37;
            --obsidian: #050505;
            --glass: rgba(255, 255, 255, 0.03);
            --border: rgba(212, 175, 55, 0.3);
        }

        body {
            margin: 0;
            font-family: 'Cinzel', serif; /* Elegant, classic luxury font */
            background: var(--obsidian);
            color: #fff;
            display: flex;
            flex-direction: column;
            height: 100vh;
            overflow: hidden;
        }

        header {
            padding: 15px 40px;
            background: #000;
            border-bottom: 1px solid var(--border);
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 0 20px rgba(212, 175, 55, 0.1);
        }

        .main-layout {
            display: grid;
            grid-template-columns: 1fr 380px;
            flex-grow: 1;
            overflow: hidden;
        }

        /* Leaderboard Style */
        .leaderboard {
            background: rgba(212, 175, 55, 0.05);
            border: 1px solid var(--border);
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 20px;
        }

        .leader-item {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px solid rgba(255,255,255,0.05);
            font-size: 0.85rem;
        }

        .leader-item:last-child { border: none; }
        .rank-gold { color: var(--gold); font-weight: bold; }

        /* Card Shimmer */
        .userCard {
            background: linear-gradient(135deg, rgba(255,255,255,0.05) 0%, rgba(0,0,0,0.5) 100%);
            border: 1px solid var(--border);
            padding: 25px;
            text-align: center;
            position: relative;
            overflow: hidden;
            transition: 0.5s;
        }

        /* Diamond Shimmer Animation */
        .userCard::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: linear-gradient(45deg, transparent, rgba(255,255,255,0.1), transparent);
            transform: rotate(45deg);
            transition: 0.5s;
        }

        .userCard:hover::before {
            animation: shimmer 1.5s infinite;
        }

        @keyframes shimmer {
            0% { transform: translateX(-100%) rotate(45deg); }
            100% { transform: translateX(100%) rotate(45deg); }
        }

        .avatar-frame {
            width: 90px;
            height: 90px;
            margin: 0 auto 15px;
            border: 2px solid var(--gold);
            outline: 1px solid var(--diamond);
            transform: rotate(45deg);
            overflow: hidden;
        }

        .sidebar {
            background: #080808;
            border-left: 1px solid var(--border);
            padding: 20px;
            display: flex;
            flex-direction: column;
        }

        #chatBox { flex-grow: 1; overflow-y: auto; font-family: sans-serif; }
        .chat-msg { font-size: 0.8rem; margin-bottom: 8px; color: #ccc; }
        .chat-msg b { color: var(--gold); letter-spacing: 1px; }

        .btn {
            background: var(--gold);
            color: black;
            border: none;
            padding: 10px;
            font-family: 'Cinzel', serif;
            font-weight: bold;
            cursor: pointer;
            letter-spacing: 2px;
        }
    </style>
</head>
<body>

<header>
    <h1 style="letter-spacing: 15px; font-weight: 100; font-size: 1.2rem;">THE DIAMOND LOUNGE</h1>
    <div id="userControls"></div>
</header>

<div id="mainView" class="main-layout" style="display:none">
    <div id="exploreDiv" style="overflow-y:auto; padding:40px;">
        <div id="cardsContainer" style="display:grid; grid-template-columns:repeat(auto-fill, minmax(250px, 1fr)); gap:20px;"></div>
    </div>

    <div class="sidebar">
        <div class="leaderboard">
            <h4 style="margin:0 0 10px 0; text-align:center; color:var(--gold); font-size:0.7rem; letter-spacing:3px;">ELITE MEMBERS</h4>
            <div id="leaderboardList"></div>
        </div>

        <h4 style="font-size:0.7rem; letter-spacing:3px; opacity:0.5;">LIVE LOUNGE FEED</h4>
        <div id="chatBox"></div>
        <input id="chatInput" style="background:#000; border:1px solid #222; color:white; padding:10px;" placeholder="SEND MESSAGE..." onkeypress="if(event.key==='Enter') sendChat()">
    </div>
</div>

<script>
// --- YOUR FIREBASE CONFIG HERE ---
const firebaseConfig = {
    apiKey: "AIzaSyCDll8RH1kzGOf-ixJmSlHXGssOHSMlO3s",
    authDomain: "vibely-5128e.firebaseapp.com",
    projectId: "vibely-5128e",
    storageBucket: "vibely-5128e.firebasestorage.app",
    messagingSenderId: "1048550825812",
    appId: "1:1048550825812:web:fc5bbba51e065807ffb2c1"
};

firebase.initializeApp(firebaseConfig);
const auth = firebase.auth();
const db = firebase.firestore();

// --- LEADERBOARD LOGIC ---
function loadLeaderboard() {
    db.collection('users').orderBy('vibes', 'desc').limit(3).onSnapshot(snap => {
        const list = document.getElementById('leaderboardList');
        list.innerHTML = '';
        let rank = 1;
        snap.forEach(doc => {
            const u = doc.data();
            list.innerHTML += `
                <div class="leader-item">
                    <span class="${rank === 1 ? 'rank-gold' : ''}">${rank}. ${u.name || 'ANON'}</span>
                    <span>♦ ${u.vibes || 0}</span>
                </div>`;
            rank++;
        });
    });
}

function giftDiamond(id, name) {
    if(auth.currentUser.uid === id) return;
    db.collection('users').doc(id).update({vibes: firebase.firestore.FieldValue.increment(1)});
    db.collection('chat').add({
        msg: `transferred 1.0 CT Diamond to ${name}`,
        user: "VAULT",
        time: firebase.firestore.FieldValue.serverTimestamp()
    });
}

function sendChat() {
    const text = document.getElementById('chatInput').value;
    if(!text) return;
    db.collection('chat').add({
        msg: text,
        user: auth.currentUser.email.split('@')[0].toUpperCase(),
        time: firebase.firestore.FieldValue.serverTimestamp()
    });
    document.getElementById('chatInput').value = '';
}

function loadUsers() {
    db.collection('users').onSnapshot(snap => {
        const container = document.getElementById('cardsContainer');
        container.innerHTML = '';
        snap.forEach(doc => {
            const u = doc.data();
            const id = doc.id;
            const card = document.createElement('div');
            card.className = 'userCard';
            card.innerHTML = `
                <div class="avatar-frame"><img src="https://api.dicebear.com/7.x/miniavs/svg?seed=${id}"></div>
                <h5 style="margin:10px 0; letter-spacing:2px;">${u.name || 'GUEST'}</h5>
                <div style="color:var(--gold); font-size:1.4rem; margin-bottom:15px;">♦ ${u.vibes || 0}</div>
                ${id !== auth.currentUser.uid ? `<button class="btn" onclick="giftDiamond('${id}', '${u.name}')">GIFT</button>` : `<small style="opacity:0.3">YOU</small>`}
            `;
            container.appendChild(card);
        });
    });
}

function loadChat() {
    db.collection('chat').orderBy('time', 'desc').limit(15).onSnapshot(snap => {
        const box = document.getElementById('chatBox');
        box.innerHTML = '';
        snap.forEach(doc => {
            const d = doc.data();
            box.innerHTML += `<div class="chat-msg"><b>${d.user}:</b> ${d.msg}</div>`;
        });
    });
}

auth.onAuthStateChanged(user => {
    if(user) {
        document.getElementById('mainView').style.display = 'grid';
        loadUsers(); loadChat(); loadLeaderboard();
    } else {
        // Simple redirect to a login prompt if not authenticated
    }
});
</script>
</body>
</html>
