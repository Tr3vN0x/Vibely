<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Vibely | Professional Social Network</title>

    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-storage-compat.js"></script>

    <style>
        :root {
            --primary: #1877f2;
            --bg: #f0f2f5;
            --card-bg: #ffffff;
            --text: #1c1e21;
            --text-gray: #65676b;
            --divider: #dadde1;
            --hover: #f2f2f2;
        }

        body { margin: 0; font-family: 'Segoe UI', Roboto, Helvetica, Arial, sans-serif; background: var(--bg); color: var(--text); }
        
        /* HEADER */
        header { 
            background: var(--card-bg); height: 60px; padding: 0 20px; 
            display: flex; justify-content: space-between; align-items: center; 
            box-shadow: 0 2px 4px rgba(0,0,0,.08); position: sticky; top: 0; z-index: 1000;
        }
        .logo { color: var(--primary); font-size: 30px; font-weight: 800; text-decoration: none; letter-spacing: -1.5px; }
        
        nav { display: flex; gap: 8px; }
        nav button { 
            background: none; border: none; width: 110px; height: 50px; 
            font-size: 24px; cursor: pointer; color: var(--text-gray); 
            border-radius: 8px; transition: 0.2s; position: relative;
        }
        nav button:hover { background: var(--hover); }
        nav button.active { color: var(--primary); }
        nav button.active::after { content: ''; position: absolute; bottom: 0; left: 0; width: 100%; height: 3px; background: var(--primary); }

        /* CONTAINER */
        .main-layout { display: grid; grid-template-columns: 320px 1fr 320px; gap: 40px; padding: 20px; max-width: 1300px; margin: auto; }

        /* CARDS */
        .card { background: var(--card-bg); border-radius: 10px; padding: 16px; margin-bottom: 20px; box-shadow: 0 1px 2px rgba(0,0,0,.1); border: 1px solid rgba(0,0,0,.05); }

        /* COMPOSER */
        .composer-box { display: flex; gap: 12px; }
        .avatar { width: 40px; height: 40px; border-radius: 50%; background: #ddd; background-size: cover; flex-shrink: 0; }
        .fake-input { 
            background: #f0f2f5; border-radius: 20px; padding: 10px 16px; flex: 1; 
            color: var(--text-gray); cursor: pointer; transition: 0.2s; border: none; font-size: 15px;
        }
        .fake-input:hover { background: #e4e6eb; }

        /* POSTS */
        .post-header { display: flex; align-items: center; gap: 12px; margin-bottom: 12px; }
        .post-user b { font-size: 15px; color: var(--text); }
        .post-user span { font-size: 13px; color: var(--text-gray); display: block; }
        .post-text { font-size: 15px; line-height: 1.5; margin-bottom: 12px; }
        .post-img { width: calc(100% + 32px); margin-left: -16px; border-top: 1px solid #eee; border-bottom: 1px solid #eee; display: block; }
        
        .post-stats { padding: 10px 0; display: flex; justify-content: space-between; font-size: 14px; color: var(--text-gray); }
        .post-actions { display: flex; border-top: 1px solid var(--divider); padding-top: 4px; }
        .action-btn { 
            flex: 1; background: none; border: none; padding: 10px; 
            color: var(--text-gray); font-weight: 600; cursor: pointer; 
            border-radius: 4px; transition: 0.2s;
        }
        .action-btn:hover { background: var(--hover); }

        /* AUTH (The Professional Look) */
        .auth-wrapper { display: flex; min-height: 90vh; align-items: center; justify-content: center; gap: 80px; }
        .auth-brand { max-width: 400px; }
        .auth-brand h1 { color: var(--primary); font-size: 58px; margin: 0; }
        .auth-brand p { font-size: 26px; line-height: 1.2; font-weight: 500; }
        .auth-form { background: white; padding: 20px; border-radius: 8px; box-shadow: 0 4px 12px rgba(0,0,0,.15); width: 396px; }
        .auth-form input { width: 100%; padding: 14px; margin-bottom: 12px; border: 1px solid #ddd; border-radius: 6px; box-sizing: border-box; font-size: 17px; }
        .btn-login { width: 100%; background: var(--primary); color: white; border: none; padding: 14px; border-radius: 6px; font-size: 20px; font-weight: bold; cursor: pointer; }

        .hidden { display: none; }
        @media (max-width: 1000px) { .main-layout { grid-template-columns: 1fr; } .side { display: none; } }
    </style>
</head>
<body>

<header id="app-header" class="hidden">
    <a href="#" class="logo">vibely</a>
    <nav>
        <button class="active" onclick="showTab('feed')">üè†</button>
        <button onclick="showTab('reels')">üì∫</button>
        <button onclick="logout()">üëã</button>
    </nav>
    <div style="width: 40px; height: 40px;" class="avatar"></div>
</header>

<div id="auth" class="auth-wrapper">
    <div class="auth-brand">
        <h1>vibely</h1>
        <p>Connect with people who matter to you.</p>
    </div>
    <div class="auth-form">
        <input id="email" type="email" placeholder="Email address" />
        <input id="password" type="password" placeholder="Password" />
        <button class="btn-login" onclick="login()">Log In</button>
        <hr style="margin: 20px 0; border: 0; border-top: 1px solid #ddd">
        <button onclick="register()" style="background:#42b72a; color:white; border:none; padding:12px 20px; border-radius:6px; font-weight:bold; cursor:pointer; width:60%; margin:0 auto; display:block">Create New Account</button>
        <p id="authError" style="color:red; text-align:center; font-size:14px; margin-top:10px"></p>
    </div>
</div>

<div id="app" class="hidden">
    <div class="main-layout">
        
        <div class="side">
            <div class="card" style="box-shadow:none; background:transparent">
                <h3>Settings</h3>
                <input id="uName" placeholder="Edit Display Name" style="width:100%; padding:10px; border-radius:8px; border:1px solid #ccc; margin-bottom:10px" />
                <label style="font-size:14px"><input type="checkbox" id="vBadge"> Verified Badge</label>
                <button onclick="updateProfile()" style="width:100%; margin-top:10px; padding:8px; border-radius:5px; border:none; background:var(--primary); color:white; font-weight:600; cursor:pointer">Save Profile</button>
            </div>
        </div>

        <main>
            <div class="card">
                <div class="composer-box">
                    <div class="avatar"></div>
                    <textarea id="pText" class="fake-input" placeholder="What's on your mind?"></textarea>
                </div>
                <hr style="border:0; border-top:1px solid #eee; margin: 15px 0">
                <div style="display:flex; justify-content:space-around">
                    <input type="file" id="iUpload" style="display:none" onchange="postContent()">
                    <button class="action-btn" onclick="document.getElementById('iUpload').click()">üì∑ Photo</button>
                    <button class="action-btn" onclick="postContent()" style="color:var(--primary)">üöÄ Post</button>
                </div>
            </div>
            <div id="feed-items"></div>
        </main>

        <div class="side">
            <div class="card">
                <h4>Global Chat</h4>
                <div id="chat-messages" style="height:350px; overflow-y:auto; font-size:14px; border-bottom:1px solid #eee; margin-bottom:10px"></div>
                <input id="chatIn" placeholder="Aa" style="width:100%; border:none; background:#f0f2f5; padding:8px 12px; border-radius:20px" />
            </div>
        </div>

    </div>
</div>

<script>
// USE YOUR FIREBASE CONFIG HERE
const firebaseConfig = {
    apiKey: "AIzaSyCDll8RH1kzGOf-ixJmSlHXGssOHSMlO3s",
    authDomain: "vibely-5128e.firebaseapp.com",
    projectId: "vibely-5128e",
    storageBucket: "vibely-5128e.firebasestorage.app",
    messagingSenderId: "1048550825812",
    appId: "1:1048550825812:web:fc5bbba51e065807ffb2c1"
};

firebase.initializeApp(firebaseConfig);
const auth = firebase.auth();
const db = firebase.firestore();
const storage = firebase.storage();

// Auth Control
auth.onAuthStateChanged(user => {
    if(user) {
        document.getElementById('auth').classList.add('hidden');
        document.getElementById('app').classList.remove('hidden');
        document.getElementById('app-header').classList.remove('hidden');
        syncProfile(); loadPosts(); loadGlobalChat();
    } else {
        document.getElementById('auth').classList.remove('hidden');
        document.getElementById('app').classList.add('hidden');
        document.getElementById('app-header').classList.add('hidden');
    }
});

function login(){ auth.signInWithEmailAndPassword(email.value, password.value).catch(e => authError.innerText = e.message); }
function register(){ auth.createUserWithEmailAndPassword(email.value, password.value).catch(e => authError.innerText = e.message); }
function logout(){ auth.signOut(); }

// Profile logic
function syncProfile() {
    db.collection('users').doc(auth.currentUser.uid).get().then(doc => {
        if(doc.exists) {
            uName.value = doc.data().username || "";
            vBadge.checked = doc.data().verified || false;
        }
    });
}
function updateProfile() {
    db.collection('users').doc(auth.currentUser.uid).set({username: uName.value, verified: vBadge.checked}, {merge:true}).then(()=>alert("Saved"));
}

// Feed logic
async function postContent() {
    const text = pText.value;
    const file = iUpload.files[0];
    const uDoc = await db.collection('users').doc(auth.currentUser.uid).get();
    const u = uDoc.data() || {username: "Vibely User"};
    
    let url = null;
    if(file) {
        const ref = storage.ref('p/'+Date.now());
        await ref.put(file);
        url = await ref.getDownloadURL();
    }
    if(!text && !url) return;

    db.collection('posts').add({
        text, img: url, uid: auth.currentUser.uid,
        name: u.username, v: u.verified, likes: 0,
        ts: firebase.firestore.FieldValue.serverTimestamp()
    });
    pText.value = ''; iUpload.value = '';
}

function loadPosts() {
    db.collection('posts').orderBy('ts', 'desc').onSnapshot(snap => {
        const box = document.getElementById('feed-items');
        box.innerHTML = '';
        snap.forEach(d => {
            const p = d.data();
            box.innerHTML += `
                <div class="card">
                    <div class="post-header">
                        <div class="avatar"></div>
                        <div class="post-user">
                            <b>${p.name || 'User'} ${p.v ? '<span style="color:#1877f2">‚úî</span>' : ''}</b>
                            <span>Just now ¬∑ üåé</span>
                        </div>
                    </div>
                    <div class="post-text">${p.text || ''}</div>
                    ${p.img ? `<img src="${p.img}" class="post-img">` : ''}
                    <div class="post-stats"><span>üëç ${p.likes || 0} likes</span></div>
                    <div class="post-actions">
                        <button class="action-btn" onclick="likePost('${d.id}')">üëç Like</button>
                        <button class="action-btn">üí¨ Comment</button>
                        <button class="action-btn">‚Ü™Ô∏è Share</button>
                    </div>
                </div>`;
        });
    });
}
function likePost(id) { db.collection('posts').doc(id).update({likes: firebase.firestore.FieldValue.increment(1)}); }

// Chat logic
function loadGlobalChat() {
    db.collection('chat').orderBy('ts').onSnapshot(s => {
        const c = document.getElementById('chat-messages');
        c.innerHTML = '';
        s.forEach(d => c.innerHTML += `<div style="margin-bottom:8px"><b>${d.data().u}:</b> ${d.data().t}</div>`);
        c.scrollTop = c.scrollHeight;
    });
}
chatIn.addEventListener('keypress', e => {
    if(e.key==='Enter' && chatIn.value) {
        db.collection('chat').add({t: chatIn.value, u: auth.currentUser.email.split('@')[0], ts: firebase.firestore.FieldValue.serverTimestamp()});
        chatIn.value = '';
    }
});

function showTab(t) { /* Simple tab logic */ }
</script>
</body>
</html>
