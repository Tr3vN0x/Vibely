<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Vibely | Winter Vault 2026</title>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

<link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@700&family=Plus+Jakarta+Sans:wght@300;400;600;800&display=swap" rel="stylesheet">

<style>
:root {
--gold:#f59e0b;--ice:#38bdf8;--mythic:#d946ef;--bg:#020617;--card:rgba(15,23,42,.75);--border:rgba(255,255,255,.1)
}
*{box-sizing:border-box}
body{margin:0;font-family:'Plus Jakarta Sans',sans-serif;background:var(--bg);color:#f8fafc;height:100vh;display:flex;flex-direction:column;overflow:hidden}
header{padding:1rem 2rem;background:#000c;border-bottom:1px solid var(--border);display:flex;justify-content:space-between;align-items:center}
.layout{display:grid;grid-template-columns:240px 1fr 320px;flex:1}
nav{padding:1.5rem;background:#0005;border-right:1px solid var(--border);display:flex;flex-direction:column;gap:.5rem}
.nav-link{padding:1rem;border-radius:14px;cursor:pointer;font-size:.75rem;font-weight:800;color:#64748b;text-transform:uppercase}
.nav-link.active,.nav-link:hover{background:var(--card);color:var(--ice)}
main{padding:2.5rem;overflow-y:auto}
.view{display:none}
.grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(220px,1fr));gap:1.5rem}
.vault-card{background:var(--card);border:1px solid var(--border);border-radius:24px;padding:2rem;text-align:center}
.vault-card:hover{transform:translateY(-5px);box-shadow:0 10px 40px rgba(56,189,248,.2)}
.mythic-glow{border-color:var(--mythic);box-shadow:0 0 25px rgba(217,70,239,.4)}
.card-icon{font-size:3rem;margin-bottom:1rem}
.btn{background:var(--ice);border:none;border-radius:12px;padding:12px;font-weight:800;cursor:pointer;width:100%}
.btn:disabled{background:#1e293b;color:#64748b}
.chat{background:#0005;border-left:1px solid var(--border);padding:1rem;display:flex;flex-direction:column}
.chat-log{flex:1;overflow-y:auto;display:flex;flex-direction:column;gap:.5rem}
.chat-msg{background:var(--card);padding:.75rem;border-radius:12px;font-size:.75rem}
.toast{position:fixed;bottom:30px;left:50%;transform:translateX(-50%);background:var(--card);padding:12px 20px;border-radius:14px;border:1px solid var(--border);font-weight:700;animation:fadeUp 3s ease forwards;z-index:9999}
@keyframes fadeUp{0%{opacity:0;transform:translate(-50%,20px)}10%{opacity:1}90%{opacity:1}100%{opacity:0;transform:translate(-50%,-20px)}}
</style>
</head>
<body>

<header>
<div style="font-family:Cinzel;color:var(--ice);letter-spacing:3px">VIBELY</div>
<div id="diamonds">â™¦ 0</div>
</header>

<div class="layout">
<nav>
<div class="nav-link active" onclick="nav('lounge')">Citizens</div>
<div class="nav-link" onclick="nav('shop')">Boutique</div>
<div class="nav-link" onclick="nav('inv')">Inventory</div>
<div class="nav-link" onclick="nav('rank')">Ranks</div>
<div class="nav-link" style="margin-top:auto;color:#ef4444" onclick="auth.signOut()">Logout</div>
</nav>

<main>
<section id="view-lounge" class="view" style="display:block"><h2>Vault Lounge</h2><div id="lounge" class="grid"></div></section>
<section id="view-shop" class="view"><h2>Boutique</h2><div id="shop" class="grid"></div></section>
<section id="view-inv" class="view"><h2>My Treasury</h2><div id="inv" class="grid"></div></section>
<section id="view-rank" class="view"><h2>Hall of Frost</h2><div id="ranks"></div></section>
</main>

<aside class="chat">
<div id="chat" class="chat-log"></div>
<input id="chatInput" placeholder="Send message" onkeydown="if(event.key==='Enter')sendChat()" />
</aside>
</div>

<script>
const firebaseConfig={apiKey:"AIzaSyCDll8RH1kzGOf-ixJmSlHXGssOHSMlO3s",authDomain:"vibely-5128e.firebaseapp.com",projectId:"vibely-5128e"};
firebase.initializeApp(firebaseConfig);
const db=firebase.firestore();
const auth=firebase.auth();

const SHOP=[
{id:'c1',name:'Frost Fox',cost:100,pfp:'ðŸ¦Š'},
{id:'c2',name:'Polar Bear',cost:300,pfp:'ðŸ»'},
{id:'c3',name:'Glacier King',cost:700,pfp:'ðŸ‘‘',mythic:true},
{id:'c1e',name:'Arctic Fox',pfp:'ðŸ¦Šâ„ï¸',requires:'c1',evolveCost:300,mythic:true}
];

let me=null;

function toast(m){const t=document.createElement('div');t.className='toast';t.innerText=m;document.body.appendChild(t);setTimeout(()=>t.remove(),3000)}

auth.onAuthStateChanged(u=>{
if(!u)return location.reload();
db.collection('users').doc(u.uid).onSnapshot(d=>{me=d.data();render();dailyReward()});
renderLounge();renderRanks();renderChat();
});

function render(){document.getElementById('diamonds').innerText=`â™¦ ${me.vibes}`;renderShop();renderInv()}

function dailyReward(){if(Date.now()- (me.lastLoginReward||0)<86400000)return;
db.collection('users').doc(auth.currentUser.uid).update({vibes:firebase.firestore.FieldValue.increment(50),lastLoginReward:Date.now()});toast('ðŸŽ Daily Reward +50â™¦')}

function renderShop(){shop.innerHTML='';SHOP.forEach(i=>{if(i.requires)return;const owned=me.inventory?.includes(i.id);
shop.innerHTML+=`<div class="vault-card ${i.mythic?'mythic-glow':''}"><div class="card-icon">${i.pfp}</div><b>${i.name}</b><p>â™¦${i.cost}</p><button class="btn" ${owned?'disabled':''} onclick="buy('${i.id}',${i.cost})">${owned?'OWNED':'BUY'}</button></div>`})}

function buy(id,c){if(me.vibes<c)return toast('Not enough â™¦');db.collection('users').doc(auth.currentUser.uid).update({vibes:firebase.firestore.FieldValue.increment(-c),inventory:firebase.firestore.FieldValue.arrayUnion(id)})}

function renderInv(){inv.innerHTML='';(me.inventory||[]).forEach(id=>{const i=SHOP.find(x=>x.id===id);if(!i)return;
const evo=SHOP.find(e=>e.requires===id);
inv.innerHTML+=`<div class="vault-card ${i.mythic?'mythic-glow':''}"><div class="card-icon">${i.pfp}</div>${evo?`<button class="btn" onclick="evolve('${id}','${evo.id}',${evo.evolveCost})">EVOLVE</button>`:''}</div>`})}

function evolve(b,e,c){if(me.vibes<c)return toast('Need more â™¦');db.collection('users').doc(auth.currentUser.uid).update({vibes:firebase.firestore.FieldValue.increment(-c),inventory:firebase.firestore.FieldValue.arrayRemove(b)}).then(()=>db.collection('users').doc(auth.currentUser.uid).update({inventory:firebase.firestore.FieldValue.arrayUnion(e)}));toast('ðŸ§¬ Evolution Complete')}

function renderLounge(){db.collection('users').onSnapshot(s=>{lounge.innerHTML='';s.forEach(d=>{lounge.innerHTML+=`<div class="vault-card"><b>${d.data().name}</b></div>`})})}

function renderRanks(){db.collection('users').orderBy('xp','desc').limit(10).onSnapshot(s=>{ranks.innerHTML='';s.forEach((d,i)=>{ranks.innerHTML+=`<div>#${i+1} ${d.data().name} â€“ XP ${d.data().xp}</div>`})})}

function sendChat(){const i=chatInput;if(!i.value)return;db.collection('chat').add({user:me.name,msg:i.value,time:Date.now()});i.value=''}
function renderChat(){db.collection('chat').orderBy('time').limitToLast(25).onSnapshot(s=>{chat.innerHTML='';s.forEach(d=>chat.innerHTML+=`<div class="chat-msg"><b>${d.data().user}</b> ${d.data().msg}</div>`);chat.scrollTop=99999})}

function nav(t){document.querySelectorAll('.view').forEach(v=>v.style.display='none');document.getElementById('view-'+t).style.display='block';document.querySelectorAll('.nav-link').forEach(n=>n.classList.remove('active'));event.target.classList.add('active')}
</script>
</body>
</html>
